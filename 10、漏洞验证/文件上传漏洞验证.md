### 1、禁用JS类型绕过漏洞

```
案例：杰奇CMS1.7
特点：图片在前台进行校验
过程：
1、firebug禁用检测文件类型js脚本
2、firebug修改允许上传类型
修改建议：
1.客户端检测，使用JS对上传图片检测，包括文件大小、文件扩展名、文件类型等
2.服务端检测，对文件大小、文件路径、文件扩展名、文件类型、文件内容检测，对文件重命名
3.其他限制，服务器端上传目录设置不可执行权限
```

### 2、MIME类型绕过漏洞

```
特点：通过Content-Type进行格式校验
过程：
1、burp suite抓包
2、修改Content-Type: text/plain为
Content-Type: image/pjpeg
Content-Type: image/jpeg
Content-Type: image/png
Content-Type: image/jpg
```

### 3、文件扩展名绕过漏洞

```
特点：当文件上传针对.php文件进行过滤时，可以尝试改为php2、php3、php4 、php5进行上传解析。
过程：将php改为其他后缀
```

### 4、文件内容检测绕过类上传漏洞

```
过程：
1、上传正常文件，并通过burp suite进行抓包
2、将一句话木马插入burp suite拦截包中
3、将图片后缀改为php
4、放行
```

### 5、空字节截断目录路径检测绕过类上传漏洞

```
特点：通过00截断，阻断对后缀的解析
过程：
1、将一句话木马改为 .jpg文件
2、利用burp suite进行抓包
3、找到上传后的保存路径  // 如upload/
4、在上传地址后输入，1.php .jpg     //1.php[空格].jpg
5、转到Hex,进入数据包二进制模式，找到1.php[空格].jpg地址。    
6、[空格]二进制解析为20，将20修改为00
```

### 6、目录路径检测解析绕过上传漏洞

```
特点：适用于IIS6.0解析漏洞，在解析到1.asp后/（反斜杠时，会进行截断）muma.jpg不再被解析
过程：
1、正常上传muma.asp类型一句话木马
2、利用burp suite进行抓包
3、找到上传后的保存路径   //如upload/
4、在保存路径后添加1.asp/    //最后保存的路径为upload/1.asp
5、将原有muma.asp改名为muma.jpg
6、最后访问的地址为：http://192.168.10.139/upload/1.asp/muma.jpg
```

### 7、IIS6.0解析缺陷绕过上传漏洞

```
特点：适用于IIS6.0
原理：iis6.0从左往右读取文件名，当遇到；分号后，会产生内存截断，分号后内容会被截断掉
支持格式：a.asa a.cer a.cdx
1、正常上传muma.asp类型一句话木马
2、利用burp suite进行抓包
3、找到上传后的保存路径   //如upload/
4、在保存路径后添加1.asp；  //分号
5、将muma.asp改名为muma.jpg     //木马.jpg会重命名为带有时间戳的文件名 1412790008.jpg
6、上传
7、最终地址为：http://192.168.10.139/upload/1.asp;1412790008.jpg   //url为连接菜刀的完整地址
```

8、Apache解析缺陷绕过上传漏洞

```
特点：忽略最后一个无法解析的格式，自动解析前面格式
1、如允许上传.7z格式文件，但并未对.7z进行解析
2、将muma.php改为muma.php.7z
3、最终地址为：http://192.168.10.139/muma.php.7z
或者
a.php.a;.jpg   //apache
```

9、htaccess文件上传解析漏洞

```
特点：上传htaccess文件，修改文件配置，允许.jpg解析为php
具体代码为 AddType application/x-httpd-php .jpg
1、将带有上述代码的.htaccess文件进行上传
2、将木马改为.jpg然后进行上传
3、最终地址为http://192.168.10.139/muma.jpg
```

10、FCK编辑器上传漏洞

```
FCK2.6.6
1、利用iis解析漏洞，创建1.asp文件夹，然后上传图片马
2、fck会把.解析成下划线
3、将muma.asp改为muma.jpg,进行上传
FCK2.4.2
与2.6.6方法相同
```

11、IIS 7.0/IIS 7.5 Nginx <8.03解析漏洞

```
a.php.jpg      //nginx
a.php;.jpg    //2003
```





















